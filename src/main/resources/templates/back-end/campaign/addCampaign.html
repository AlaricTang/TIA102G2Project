<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
     <!--  ======== Document Title =====================================  -->
    <title>後台首頁</title>


    <!-- ●●css for jquery datatables 用 -->
    <link rel="stylesheet" th:href="@{/css/styleBack.css}" type="text/css" >
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/style.min.css" />
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.5/css/dataTables.jqueryui.min.css" />
    

    <script th:src="@{/js/scriptsBack.js}"></script>
   	<script th:src="@{/js/datatables-simple-demo.js}"></script>
 	<script th:src="@{/demo/chart-area-demo.js}"></script>
 	<script th:src="@{/demo/chart-bar-demo.js}"></script>
 	<script th:src="@{/demo/chart-pie-demo.js}"></script>
    
    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>                                    <!-- ●●js  for jquery datatables 用 -->
    <script	src="https://cdn.datatables.net/1.13.5/js/jquery.dataTables.min.js"></script>              <!-- ●●js  for jquery datatables 用 -->
    <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" ></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" ></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js" ></script>
    <script src="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/umd/simple-datatables.min.js" ></script>  
      
 	<style type="text/css">
		
		.form-item {
		    display: inline-block;
		    margin-right: 10px;
		    margin-bottom: 10px;
		    width: 45%;
		}
		
		.form-item label {
		    display: block;
		    margin-bottom: 5px;
		    font-weight: bold;
		}
		
		.form-item input,
		.form-item select {
		    width: 100%;
		    padding: 8px;
		    box-sizing: border-box;
		    border: 1px solid #ccc;
		    border-radius: 4px;
		}
		
		.form-dateitem label {
		    display: block;
		    margin-bottom: 5px;
		    font-weight: bold;
		}
		
		.form-dateitem input {
			width: 40%;
		    padding: 8px;
		    box-sizing: border-box;
		    border: 1px solid #ccc;
		    border-radius: 4px;
		}
		
		.error {
		    color: red;
		    font-size: 0.875em;
		}
		
		#campaignPdTable{
			width: 100%;
		    border-collapse: collapse;
		    margin-bottom: 20px;
		    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
		    font-family: Arial, sans-serif;
		    font-size: 14px;
		}
		
		#image-preview {
		    margin-top: 15px;
		    display: flex;
		    justify-content: center;
		    align-items: center;
		    border: 1px dashed #ccc;
		    padding: 10px;
		    border-radius: 4px;
		}
		
		#image-preview img {
		    width: 100%;
		    height: auto;
		    max-width: 400px; /* 增大圖片預覽框寬度 */
		    max-height: 400px; /* 增大圖片預覽框高度 */
		    border-radius: 4px;
		}
		
		#submit {
		    display: inline-block;
		    background-color: #4CAF50;
		    color: white;
		    padding: 10px 20px;
		    border: none;
		    border-radius: 4px;
		    cursor: pointer;
		}
		
		#submit:hover {
		    background-color: #45a049;
		}
		
		.form-container {
		    max-width: 800px;
		    margin: auto;
		}
		
		.form-header {
		    text-align: center;
		    margin-bottom: 20px;
		}
		
		.status-returned {
		    background-color: #d4edda;
		    color: #155724;
		    padding: 5px;
		    border-radius: 5px;
		    border: 1px solid #c3e6cb;
		}
		
		.status-rented {
		    background-color: #fff3cd;
		    color: #856404;
		    padding: 5px;
		    border-radius: 5px;
		    border: 1px solid #ffeeba;
		}
		
		.status-scrapped {
		    background-color: #f8d7da;
		    color: #721c24;
		    padding: 5px;
		    border-radius: 5px;
		    border: 1px solid #f5c6cb;
		}
		
		.status-unknown {
		    background-color: #d6d8d9;
		    color: #383d41;
		    padding: 5px;
		    border-radius: 5px;
		    border: 1px solid #c6c8ca;
		}
		
		.card-body {
		    background-color: #f9f9f9;
		    padding: 20px;
		    border-radius: 10px;
		    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
		}
		
		#example {
		    width: 100%;
		    border-collapse: collapse;
		    margin-bottom: 20px;
		}
		
		#example thead tr {
		    background-color: #4CAF50;
		    color: white;
		}
		
		#example th, #example td {
		    padding: 12px 15px;
		    border-bottom: 1px solid #ddd;
		    text-align: center;
		}
		
		#example tbody tr:nth-child(even) {
		    background-color: #f2f2f2;
		}
		
		#example tbody tr:hover {
		    background-color: #e6f7ff;
		}
		
		.btn-primary {
		    background-color: #007bff;
		    color: white;
		    border: none;
		    padding: 6px 12px;
		    border-radius: 4px;
		    cursor: pointer;
		    transition: background-color 0.3s;
		}
		
		.btn-primary:hover {
		    background-color: #0056b3;
		}
		
		#campaignPdBtn {
			background-color: #007bff;
		    color: white;
		    border: none;
		    padding: 6px 12px;
		    border-radius: 4px;
		    cursor: pointer;
		    transition: background-color 0.3s;
		}
		
		#campaignPdBtn:hover {
		    background-color: #0056b3;
		}
		
		
	</style>
	
</head>

<body class="sb-nav-fixed">

	<!-- header -->
    <div th:include="headerBack :: headerBack"></div>
    <!-- header -->

    <div id="layoutSidenav">
        <!-- footer -->
      	<div th:include="SliderLeftBack :: SliderLeftBack"></div>
      	<!-- footer -->

        <!--右半邊的空白頁 -->
        <div id="layoutSidenav_content">
        	<main>
				<div class="container-fluid px-4">
			    	<h1 class="mt-4">創建活動</h1>
			        
			        <!-- 主要內容 -->
			        <div class="card mb-4">
			        	 <div class="card-header">
			                 <i class="fas fa-plus me-1"></i>
			                 建立活動表單
			             </div>
			             <div class="card-body">
			             	<div class="form-container">
			             	<!-- 主要內容 -->
			             	
			             	
			             	
					      <form th:action="@{/campaign/insert}" method="post" th:object="${campaignVO}" enctype="multipart/form-data">
					      	<h2 class="form-header" ><b>請輸入下列資訊</b></h2>
					      	
					        <div class="form-item">
					            <label for="campaignName">活動名稱</label>
					            <input type="text" th:field="*{campaignName}" onclick="hideContent('campaignName.errors');" /><br/>
					            <span  th:if="${#fields.hasErrors('campaignName')}" th:errors="*{campaignName}" class="error" id="campaignName.errors"></span>
					        </div>
					        <br>
					        
<!-- 					        <div class="form-item"></div> -->
					        
					        
					        <div class="form-item">
					            <label>活動折扣:</label>
					            <input type="text" th:field="*{campaignDiscount}" onclick="hideContent('campaignDiscount.errors');" /><br/>
					            <span  th:if="${#fields.hasErrors('campaignDiscount')}" th:errors="*{campaignDiscount}" class="error" id="campaignDiscount.errors"></span>
					        </div>

					        <div class="form-dateitem">
					            <label>活動時間:</label>
					            <input  type="date" th:field="*{campaignStartDate}"/> 至
					            <input  type="date" th:field="*{campaignEndDate}" /><br>
					            <span th:if="${#fields.hasErrors('campaignStartDate')}" th:errors="*{campaignStartDate}" class="error" id="campaignStartDate.errors"></span>
					            <span th:if="${#fields.hasErrors('campaignEndDate')}" th:errors="*{campaignEndDate}" class="error" id="campaignEndDate.errors"></span>
					        </div><br>
					        
					        
					        <div class="form-item">
							    <label>照片:</label>
							    <input type="file" th:field="*{campaignPic}" multiple="multiple" onchange="previewImages(event);" />
							    <span class="error" th:utext="${errorMessage}" id="campaignPic.errors">${errorMessage}</span>
							    <div id="image-preview" style="display: flex; gap: 10px; flex-wrap: wrap;"></div>
							</div><br>
							
							<div class="form-item">
								<label>活動商品選擇:</label>
								<a id="campaignPdBtn" href="/campaign/goSelectedDrink">選擇商品</a><br>
			
								<div th:if="${session.campaignProductList != null}">
									<table id="campaignPdTable">
										<th:block th:each="campaignProductVO : ${session.campaignProductList}">
											<td th:text="${campaignProductVO.drinkID}"></td>
										</th:block>
									</table>
								</div>
							</div>
							
							
					        <div class="form-item" style="width: 100%;">
					            <label>活動描述:</label>
					            <textarea id="campaignDescription" th:field="*{campaignDes}" style="width: 100%;" rows="4"></textarea>
					            <span  th:if="${#fields.hasErrors('campaignDes')}" th:errors="*{campaignDes}" class="error" id="campaignDes.errors"></span>
					        </div>
					
					        <!-- 送出按鈕 -->
					        <div class="row mb-3">
					            <div class="col-md-12 text-center">
					                <button th:href="@{/campaign/insert}" type="submit" id="submit" class="btn btn-primary"> 送出新增 </button>
					            </div>
					        </div>
					      </form>
					      
					      
		             	</div>
		             </div>
		        </div>
		    </div>
			</main>        
        </div>
    </div>


	<!-- JavaScript part -->
	<script>
	    function previewImages(event) {
	        const files = event.target.files;
	        const preview = document.getElementById('image-preview');
	        preview.innerHTML = '';  // 清空之前的預覽
	
	        for (let i = 0; i < files.length; i++) {
	            const file = files[i];
	            const reader = new FileReader();
	
	            reader.addEventListener("load", function () {
	                const imgElement = document.createElement('img');
	                imgElement.src = reader.result;
	                imgElement.style.width = '100px';  // 預覽圖片的寬度
	                imgElement.style.height = '75px';  // 預覽圖片的高度
	                imgElement.style.objectFit = 'cover';
	                preview.appendChild(imgElement);
	            }, false);
	
	            if (file) {
	                reader.readAsDataURL(file);
	            }
	        }
	    }
	</script>
	<script type="text/javascript">
	//清除提示信息
	function hideContent(d) {
	     document.getElementById(d).style.display = "none";
	}
	
	//照片上傳-預覽用
	var filereader_support = typeof FileReader != 'undefined';
	if (!filereader_support) {
		alert("No FileReader support");
	}
	acceptedTypes = {
			'image/png' : true,
			'image/jpeg' : true,
			'image/gif' : true
	};
	function previewImage() {
		var upfile1 = document.getElementById("drinkPic");
		upfile1.addEventListener("change", function(event) {
			var files = event.target.files || event.dataTransfer.files;
			for (var i = 0; i < files.length; i++) {
				previewfile(files[i])
			}
		}, false);
	}
	function previewfile(file) {
		if (filereader_support === true && acceptedTypes[file.type] === true) {
			var reader = new FileReader();
			reader.onload = function(event) {
				var image = new Image();
				image.src = event.target.result;
				image.width = 100;
				image.height = 75;
				image.border = 2;
				if (blob_holder.hasChildNodes()) {
					blob_holder.removeChild(blob_holder.childNodes[0]);
				}
				blob_holder.appendChild(image);
			};
			reader.readAsDataURL(file);
			document.getElementById('submit').disabled = false;
		} else {
			blob_holder.innerHTML = "<div  style='text-align: left;'>" + "● filename: " + file.name
					+ "<br>" + "● ContentTyp: " + file.type
					+ "<br>" + "● size: " + file.size + "bytes"
					+ "<br>" + "● 上傳ContentType限制: <b> <font color=red>image/png、image/jpeg、image/gif </font></b></div>";
			document.getElementById('submit').disabled = true;
		}
	}
	</script>

</body>

</html>